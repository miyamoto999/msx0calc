10 CLEAR 200,&HDA00
20 DEF USR3=&HDA00:DEF USR4=&HDA03:DEF USR5=&HDA06:DEF USR6=&HDA09:DEF USR7=&HDA0C
30 DEFINT A-Z
40 BLOAD"calc.bin"
50 C0#=12345:D0=VARPTR(C0#)
60 C1#=6789:D1=VARPTR(C1#)
70 C2#=1.23456:D2=VARPTR(C2#)
80 _TURBO ON(D0,D1,D2)
90 AN=&HDA20:V0=&HDA28:TT=&HDA1E
100 ' test1-1 VAR_ANに値をセット
110 PRINT "test1-1:";:A$="12345":POKE TT,0:P=USR3(VARPTR(A$)):P0=AN:P1=D0:GOSUB 9010:IF F=0 THEN PRINT "OK" ELSE PRINT "NG"
120 ' test1-2 VAR_V0に値をセット
130 PRINT "test1-2:";:A$="6789":POKE TT,1:P=USR3(VARPTR(A$)):P0=V0:P1=D1:GOSUB 9010:IF F=0 THEN PRINT "OK" ELSE PRINT "NG"
140 ' test1-3 VAR_V0に値をセット
150 PRINT "test1-3:";:A$="1.23456":POKE TT,1:P=USR3(VARPTR(A$)):P0=V0:P1=D2:GOSUB 9010:IF F=0 THEN PRINT "OK" ELSE PRINT "NG"
160 ' test2-1 V0=>ANのテスト
170 PRINT "test2-1:";:A$="99923":POKE TT,1:P=USR3(VARPTR(A$)):P=USR4(0):P0=AN:P1=V0:GOSUB 9010:IF F=0 THEN PRINT "OK" ELSE PRINT "NG"
171 ' test2-2 AN=>V0のテスト
172 PRINT "test2-2:";:A$="223456":POKE TT,0:P=USR3(VARPTR(A$)):P=USR4(1):P0=AN:P1=V0:GOSUB 9010:IF F=0 THEN PRINT "OK" ELSE PRINT "NG"
180 ' test3-1 ANの値を文字列に変換する。
190 PRINT "test3-1:";:A$="4567":POKE TT,0:P=USR3(VARPTR(A$)):P=USR5(VARPTR(B$)):IF B$=" 4567" THEN PRINT "OK" ELSE PRINT "NG"
200 ' test3-2
210 PRINT "test3-2:";:A$="1.234":POKE TT,0:P=USR3(VARPTR(A$)):P=USR5(VARPTR(B$)):IF B$=" 1.234" THEN PRINT "OK" ELSE PRINT "NG"
220 ' test3-3
230 PRINT "test3-3:";:A$="5.345e30":POKE TT,0:P=USR3(VARPTR(A$)):P=USR5(VARPTR(B$)):IF B$=" 5.345E+30" THEN PRINT "OK" ELSE PRINT "NG"
240 ' test3-4
250 PRINT "test3-4:";:A$="-5.345e30":POKE TT,0:P=USR3(VARPTR(A$)):P=USR5(VARPTR(B$)):IF B$="-5.345E+30" THEN PRINT "OK" ELSE PRINT "NG"
260 ' test3-5 V0の値を文字列に変換する。
270 PRINT "test3-5:";:A$="4567":POKE TT,1:P=USR3(VARPTR(A$)):P=USR5(VARPTR(B$)):IF B$=" 4567" THEN PRINT "OK" ELSE PRINT "NG"
280 ' test3-6
290 PRINT "test3-6:";:A$="1.234":POKE TT,1:P=USR3(VARPTR(A$)):P=USR5(VARPTR(B$)):IF B$=" 1.234" THEN PRINT "OK" ELSE PRINT "NG"
300 ' test3-7
310 PRINT "test3-7:";:A$="5.345e30":POKE TT,1:P=USR3(VARPTR(A$)):P=USR5(VARPTR(B$)):IF B$=" 5.345E+30" THEN PRINT "OK" ELSE PRINT "NG"
320 ' test3-8
330 PRINT "test3-8:";:A$="-5.345e30":POKE TT,1:P=USR3(VARPTR(A$)):P=USR5(VARPTR(B$)):IF B$="-5.345E+30" THEN PRINT "OK" ELSE PRINT "NG"
340 ' test4-1 V0=V0+AN
350 PRINT "test4-1:";
360 A$="1":POKE TT,0:P=USR3(VARPTR(A$)):' AN
370 A$="2":POKE TT,1:P=USR3(VARPTR(A$)):' V0
380 P=USR6(0):IF P=-1 THEN PRINT "NG" ELSE P=USR5(VARPTR(B$)):IF B$=" 3" THEN PRINT "OK" ELSE PRINT "NG"
390 ' test4-2 V0=V0-AN
400 PRINT "test4-2:";
410 A$="1":POKE TT,0:P=USR3(VARPTR(A$)):' AN
420 A$="2":POKE TT,1:P=USR3(VARPTR(A$)):' V0
430 P=USR6(1):IF P=-1 THEN PRINT "NG" ELSE P=USR5(VARPTR(B$)):IF B$=" 1" THEN PRINT "OK" ELSE PRINT "NG"
440 ' test4-3 V0=V0*AN
450 PRINT "test4-3:";
460 A$="4":POKE TT,0:P=USR3(VARPTR(A$)):' AN
470 A$="2":POKE TT,1:P=USR3(VARPTR(A$)):' V0
480 P=USR6(2):IF P=-1 THEN PRINT "NG" ELSE P=USR5(VARPTR(B$)):IF B$=" 8" THEN PRINT "OK" ELSE PRINT "NG"
490 ' test4-4 V0=V0/AN
500 PRINT "test4-4:";
510 A$="4":POKE TT,0:P=USR3(VARPTR(A$)):' AN
520 A$="8":POKE TT,1:P=USR3(VARPTR(A$)):' V0
530 P=USR6(3):IF P=-1 THEN PRINT "NG" ELSE P=USR5(VARPTR(B$)):IF B$=" 2" THEN PRINT "OK" ELSE PRINT "NG"
540 ' test4-5 OVERFLOW
550 PRINT "test4-5:";
560 A$="2e30":POKE TT,0:P=USR3(VARPTR(A$)):' AN
570 A$="3e40":POKE TT,1:P=USR3(VARPTR(A$)):' V0
580 P=USR6(2):IF P=-1 THEN PRINT "OK" ELSE PRINT "NG"
590 ' test4-6 ZERO DIV
600 PRINT "test4-6:";
610 A$="0":POKE TT,0:P=USR3(VARPTR(A$)):' AN
620 A$="3e40":POKE TT,1:P=USR3(VARPTR(A$)):' V0
630 P=USR6(3):IF P=-1 THEN PRINT "OK" ELSE PRINT "NG"
640 ' test5-1 ANの値を符号反転
650 PRINT"test5-1:";:A$="12345":POKE TT,0:P=USR3(VARPTR(A$)):P=USR7(0):P=USR5(VARPTR(B$)):IF B$="-12345" THEN PRINT "OK" ELSE PRINT "NG"
660 ' test5-2 ANの値を符号反転
670 PRINT"test5-2:";:A$="-234":POKE TT,0:P=USR3(VARPTR(A$)):P=USR7(0):P=USR5(VARPTR(B$)):IF B$=" 234" THEN PRINT "OK" ELSE PRINT "NG"
680 ' test5-3 ANの値を符号反転
690 PRINT"test5-3:";:A$="0":POKE TT,0:P=USR3(VARPTR(A$)):P=USR7(0):P=USR5(VARPTR(B$)):IF B$=" 0" THEN PRINT "OK" ELSE PRINT "NG"
700 ' test5-4 V0の値を符号反転
710 PRINT"test5-4:";:A$="6789":POKE TT,1:P=USR3(VARPTR(A$)):P=USR7(1):P=USR5(VARPTR(B$)):IF B$="-6789" THEN PRINT "OK" ELSE PRINT "NG"
8999 END
9000 ' 
9010 F=0
9020 FOR I=0 TO 7
9030 IF PEEK(P0+I)<>PEEK(P1+I) THEN F=1
9040 'print hex$(peek(p0+i));":";hex$(peek(p1+i))
9050 NEXT I
9060 RETURN
9070 '
9080 FOR I=0 TO 7
9090 PRINT HEX$(PEEK(P0+I));":";
9100 NEXT I
9110 PRINT:RETURN
9120 _TURBO OFF